#' vafCluster
#' @description Generate variant allele frequency(VAF) frequency distribution
#'  curve in different mode.
#'  
#' @param maf a Maf object generated by readMaf function
#' @param segCN.file the segment file.
#' @param min.vaf the minimum value of VAF. Default: 0. Option: on the scale of 0 to 1
#' @param max.vaf the maximum value of VAF. Default: 0. Option: on the scale of 0 to 1
#' @param showMATH logical. Whether to show MATH Scores in the plot. Default TRUE 
#' @param plotOption character. Three options for displaying clustering of VAFs in samples. Default "compare"
#' "compare": prints comparison of VAFs distribution among samples;
#' "combine" prints VAFs distribution of samples all together;
#' 
#' @examples
#' vafCluster(maf, plotOption="compare")
#' vafCluster(maf, plotOption="combine", showMATH=FALSE)
#' 
#'
#' @export vafCluster
#' @export vafClusterRshiny
#' 

## Main function for VAF plot
vafCluster <-function(maf,
                      segCN.file = NULL,
                      min.vaf=0.02,
                      max.vaf=1,
                      showMATH=TRUE, 
                      plotOption="combine"){
  plot.options = c('combine', 'compare')
  
  if(!plotOption %in% plot.options){
    stop("plotOption can only be either 'combine' or 'compare'")
  }
  
  if(!is.null(segCN.file)){
    seg <- readSegment(segCN.file = segCN.file)
    maf <- copyNumberFilter(maf, seg)
  }
  
  if(min.vaf <= 0){
      stop("Error: min.vaf must greater than 0")
  }
  if(max.vaf < min.vaf){
      stop("Error: max.vaf must greater than min.vaf")
  }
  
  dat.list <- split(maf@data, maf@data$Patient_ID)
  result.list <- lapply(dat.list, doVafCluster,
                        maf = maf,
                        min.vaf = min.vaf,
                        max.vaf = max.vaf,
                        showMATH = showMATH, 
                        plotOption = plotOption)
  return(result.list)
}