#' @title classifyMut
#'
#' @param maf  Maf or MafList object generated by readMaf
#' Classify SSNVs/Indels into Shared/P-shared/Private, Clonal/Subclonl
#' or Shared-Clonal/P-shared-Clonal/Private-Clonal/Shared-Subclonal/P-shared-SubClonal/Private-SubClonal 
#' @param patient.id  Select the specific patients. Default: NULL, all patients are included
#' @param class  The class which would be represented, default is "SP" (Shared pattern: Public/Shared/Private),
#' other options: "CS" (Clonal status: Clonal/Subclonl) and "SPCS".
#' @param classByTumor  FALSE(Default). Classify mutations based on "Tumor_ID".
#' @param ... Other options passed to \code{\link{subsetMaf}}
#' @return a data.frame with classification of mutations 
#' 
#' @examples
#' classifyMut(maf, class = "SP")
#' @export classifyMut


classifyMut <- function(
     maf,     
     patient.id = NULL,
     class = "SP",
     classByTumor = FALSE,
     ...) {
    
    ## check input data
    maf_list <- checkMafInput(maf, patient.id=patient.id)
    
    result <- list()
    for(m in maf_list){
        maf_data <- subsetMaf(m, ...)
        patient <- getMafPatient(m)
        if(nrow(maf_data) == 0){
            message("Warning :there was no mutation in ", patient, " after filter.")
            next
        }
        mut.class <- do.classify(
            maf_data, 
            class = class,
            classByTumor = classByTumor
        ) %>% 
            dplyr::mutate(Mut_ID = paste(
                Hugo_Symbol, Chromosome,
                Start_Position,
                Reference_Allele, 
                Tumor_Seq_Allele2,
                sep = ":"
            )) %>%
            dplyr::select(
                Patient_ID, Tumor_Sample_Barcode,
                Mut_ID, Mutation_Type)
        
        result[[patient]] <- mut.class
        
    }
    
    if(length(result) > 1){
        return(result)
    }else if(length(result) == 0){
        return(NA)
    }else{
        return(result[[1]])
    }

    return(mut.class)

}
