#' @title classifyMut
#'
#' @param maf  The Maf object generated by readMaf
#' Classify SSNVs/Indels into Shared/P-shared/Private, Clonal/Subclonl
#' or Shared-Clonal/P-shared-Clonal/Private-Clonal/Shared-Subclonal/P-shared-SubClonal/Private-SubClonal 
#' @param class  The class which would be represented, default is "SP" (Shared pattern: Public/Shared/Private),
#' other options: "CS" (Clonal status: Clonal/Subclonl) and "SPCS".
#' @param patient.id  Select the specific patients. Default: NULL, all patients are included
#' @param classByType  FALSE(Default). Define shared pattern of mutations based on tumor types (TRUE) or samples (FALSE)
#' @return a data.frame with classification of mutations 
#' 
#' @examples
#' classifyMut(maf, class = "SP")
#' @export classifyMut


classifyMut <- function(
     maf,
     patient.id = NULL,
     chrSilent = NULL,
     mutType = "All",
     use.indel = TRUE,
     class = "SP",
     classByType = FALSE) {
  
    maf <- subsetMaf(maf,
                     patient.id = patient.id,
                     chrSilent = chrSilent,
                     mutType = mutType,
                     use.indel = use.indel)
    
    mut.class <- do.classify(
        maf, 
        class = class,
        patient.id = patient.id,
        classByType = classByType
        ) %>% 
        dplyr::mutate(Mut_ID = paste(
          Hugo_Symbol, Chromosome,
          Start_Position,
          Reference_Allele, 
          Tumor_Seq_Allele2,
          sep = ":"
         )) %>%
    dplyr::select(
      Patient_ID, Tumor_Sample_Barcode,
      Mut_ID, Mutation_Type)

    return(mut.class)

}
